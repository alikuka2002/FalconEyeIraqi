<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://www.dropbox.com/scl/fi/03ca3ak61fwhd913n7pno/bird-of-prey.png?rlkey=cebrvo4o0nd639xf1yi8kn7ea&st=dkn2suja&dl=1" type="image/png">
    <title>نظام الإبلاغ عن المخالفات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap');
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f5f7fa;
            background-image: url('https://images.unsplas.com/photo-1589998059171-988d322b3ddb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-blend-mode: overlay;
            transition: all 0.3s ease;
        }

        body.dark-mode {
            background-color: #0f172a;
            color: #e2e8f0;
            background-image: linear-gradient(to bottom right, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.9));
        }

        .dark-mode .card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .dark-mode .text-gray-800 {
            color: #e2e8f0;
        }

        .dark-mode .text-gray-700 {
            color: #e2e8f0;
        }

        .dark-mode .text-gray-500 {
            color: #a0aec0;
        }

        .dark-mode .bg-white {
            background-color: #2d3748;
        }

        .dark-mode .border-gray-300 {
            border-color: #4a5568;
        }

        .dark-mode .bg-gray-800 {
            background-color: #1a202c;
        }

        .dark-mode .bg-gray-50 {
            background-color: #2d3748;
        }

        .dark-mode .bg-blue-50 {
            background: rgba(30, 58, 138, 0.2);
        }

        .dark-mode .bg-green-50 {
            background: rgba(6, 78, 59, 0.2);
        }

        .dark-mode .border-gray-200 {
            border-color: #4a5568;
        }

        .dark-mode .text-blue-800 {
            color: #bee3f8;
        }

        .dark-mode .text-green-800 {
            color: #c6f6d5;
        }

        .dark-mode .file-input-label {
            border-color: #4a5568;
            background-color: #2d3748;
        }

        .dark-mode .modern-input,
        .dark-mode .modern-select,
        .dark-mode .modern-textarea {
            background: rgba(15, 23, 42, 0.8);
            border-color: rgba(59, 130, 246, 0.3);
            color: #e2e8f0;
        }

        .file-input-label {
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .map-container {
            height: 300px;
            transition: all 0.3s ease;
        }

        .map-container:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .report-btn {
            transition: all 0.3s ease;
        }

        .report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .toast {
            animation: slideIn 0.5s, fadeOut 0.5s 2.5s;
        }

        @keyframes slideIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .preview-image {
            max-height: 150px;
            object-fit: cover;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .preview-image:hover {
            transform: scale(1.05);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Custom select arrow */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: left 0.75rem center;
            background-size: 1em;
        }

        /* Custom checkbox */
        .custom-checkbox {
            position: relative;
            padding-right: 1.5rem;
            cursor: pointer;
        }

        .custom-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: absolute;
            right: 0;
            top: 0;
            height: 1.25rem;
            width: 1.25rem;
            background-color: #fff;
            border: 2px solid #d1d5db;
            border-radius: 0.25rem;
        }

        .custom-checkbox:hover input ~ .checkmark {
            background-color: #f3f4f6;
        }

        .custom-checkbox input:checked ~ .checkmark {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .custom-checkbox input:checked ~ .checkmark:after {
            display: block;
        }

        .custom-checkbox .checkmark:after {
            right: 0.35rem;
            top: 0.1rem;
            width: 0.4rem;
            height: 0.8rem;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        /* Pulse animation for important elements */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Custom radio buttons */
        .custom-radio {
            position: relative;
            padding-right: 1.75rem;
            cursor: pointer;
        }

        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .radio-mark {
            position: absolute;
            right: 0;
            top: 0;
            height: 1.25rem;
            width: 1.25rem;
            background-color: #fff;
            border: 2px solid #d1d5db;
            border-radius: 50%;
        }

        .custom-radio:hover input ~ .radio-mark {
            background-color: #f3f4f6;
        }

        .custom-radio input:checked ~ .radio-mark {
            background-color: #fff;
            border-color: #3b82f6;
        }

        .radio-mark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .custom-radio input:checked ~ .radio-mark:after {
            display: block;
        }

        .custom-radio .radio-mark:after {
            top: 0.25rem;
            right: 0.25rem;
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
            background: #3b82f6;
        }

        /* Modal content styles */
        .modal-content {
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Info sections */
        .info-section {
            display: none;
        }

        .info-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Logo styles */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .eagle-logo {
            width: 48px;
            height: 48px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
        }

        .eagle-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: brightness(0) invert(1);
        }

        /* Modern card styles */
        .card {
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card:hover {
            transform: translateY(-4px) scale(1.005);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }

        /* Enhanced form sections */
        .form-section {
            position: relative;
            overflow: hidden;
        }

        .form-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(to right, transparent, #3b82f6, transparent);
        }

        /* Modern input */
        .modern-input, .modern-select, .modern-textarea {
            backdrop-filter: blur(4px);
            border-width: 2px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-input:focus, .modern-select:focus, .modern-textarea:focus {
            transform: translateY(-1px);
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15);
        }

        .dark-mode .modern-input,
        .dark-mode .modern-select,
        .dark-mode .modern-textarea {
            background: rgba(17, 24, 39, 0.8);
            border-color: rgba(255, 255, 255, 0.1);
        }

        /* Modern button */
        .modern-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .modern-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2563eb, #1e3a8a);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .modern-btn:hover::before {
            opacity: 1;
        }

        .modern-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        /* Enhanced map container */
        .map-container {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.1);
        }

        /* Professional file upload */
        .file-input-label {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.1) 100%);
            border: 2px dashed rgba(59, 130, 246, 0.4);
        }

        /* Enhanced dark mode */
        .dark-mode .card {
            background: rgba(17, 24, 39, 0.8);
            border-color: rgba(255, 255, 255, 0.05);
        }

        /* Professional animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease forwards;
        }

        /* Dark mode toggle */
        .dark-mode-toggle {
            background: linear-gradient(145deg, #2c3e50, #34495e);
            border-radius: 20px;
            padding: 4px;
            width: 60px;
            height: 30px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dark-mode-toggle::after {
            content: '☀️';
            position: absolute;
            top: 2px;
            left: 4px;
            width: 26px;
            height: 26px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .dark-mode .dark-mode-toggle::after {
            content: '🌙';
            transform: translateX(30px);
            background: #1a202c;
            color: #fff;
        }

        /* Enhanced Location Controls */
        .location-controls {
            display: flex;
            gap: 0.5rem;
            width: 100%;
        }

        .location-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            line-height: 1.25rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .search-btn {
            background: linear-gradient(145deg, #1e40af, #3b82f6);
            color: white;
        }

        .locate-btn {
            background: linear-gradient(145deg, #059669, #10b981);
            color: white;
        }

        @media (max-width: 768px) {
            .location-controls {
                flex-wrap: wrap;
            }

            .location-btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.75rem;
            }

            .location-btn i {
                font-size: 0.875rem;
            }
        }

        /* Glass effect */
        .glass {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .dark-mode .glass {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Enhanced animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        /* Professional icon styling */
        .icon-gradient {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Language switcher */
        .lang-switch {
            padding: 0.5rem;
            border-radius: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .lang-switch span {
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-switch span.active {
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        /* RTL/LTR transitions */
        [dir="rtl"] .modern-input,
        [dir="rtl"] .modern-select,
        [dir="rtl"] .modern-textarea {
            text-align: right;
        }

        [dir="ltr"] .modern-input,
        [dir="ltr"] .modern-select,
        [dir="ltr"] .modern-textarea {
            text-align: left;
        }

        /* Enhanced search button */
        .search-btn {
            padding: 0.75rem;
            border-radius: 0.75rem;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.3);
        }

        /* Enhanced button styles */
        .action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        /* Search button next to location */
        .location-controls {
            display: flex;
            gap: 0.5rem;
            width: 100%;
            position: relative;
        }

        /* Responsive layout improvements */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .location-controls {
                flex-direction: row;
            }

            .action-btn {
                width: 100%;
            }
        }

        /* Updated icons */
        .icon-primary {
            color: #3b82f6;
            font-size: 1.5rem;
        }

        /* Enhanced Icon Container */
        .icon-container {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            position: relative;
            transition: all 0.3s ease;
        }

        .icon-container::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 12px;
            padding: 2px;
            background: linear-gradient(45deg, #3b82f6, #60a5fa);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }

        .icon-container i {
            font-size: 1rem;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 1px 2px rgba(59, 130, 246, 0.1));
        }

        /* Navigation Icons */
        .nav-icon {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));
        }

        .nav-icon i {
            font-size: 1.2rem;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-icon:hover {
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.2));
            transform: translateY(-2px);
        }

        /* Contact Info Icons */
        .contact-info-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .contact-icon {
            padding: 1rem;
            border-radius: 16px;
            background: linear-gradient(145deg, #1e40af, #3b82f6);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }

        .contact-icon:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .dark-mode .contact-icon {
            background: linear-gradient(145deg, #1e3a8a, #2563eb);
        }

        /* Work hours section styles */
        .work-hours-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .work-hours-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: #dcfce7;
        }

        .work-hours-icon i {
            font-size: 1rem;
            color: #16a34a;
        }

        .work-hours-text {
            flex: 1;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white shadow-lg glass">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="logo-container mb-4 md:mb-0">
                    <div class="eagle-logo">
                        <img src="https://www.dropbox.com/scl/fi/03ca3ak61fwhd913n7pno/bird-of-prey.png?rlkey=cebrvo4o0nd639xf1yi8kn7ea&st=dkn2suja&dl=1" 
                             alt="Eagle Logo">
                    </div>
                    <div class="logo-text">
                        <h1 class="logo-title" data-en="Eagle Eye Violation System" data-ar="نظام عين الصقر للمخالفات">
                            نظام عين الصقر للمخالفات
                        </h1>
                        <p class="logo-subtitle" data-en="Report violations easily and securely" data-ar="الإبلاغ عن المخالفات بسهولة وأمان">
                            الإبلاغ عن المخالفات بسهولة وأمان
                        </p>
                    </div>
                </div>
                <nav class="flex flex-wrap justify-center gap-x-6 gap-y-2">
                    <a href="#" id="homeBtn" class="nav-icon">
                        <i class="fas fa-house"></i>
                        <span>الرئيسية</span>
                    </a>
                    <a href="#" id="howToReportBtn" class="nav-icon">
                        <i class="fas fa-circle-info"></i>
                        <span>كيفية الإبلاغ</span>
                    </a>
                    <a href="#" id="faqBtn" class="nav-icon">
                        <i class="fas fa-circle-question"></i>
                        <span>الأسئلة الشائعة</span>
                    </a>
                    <a href="#" id="contactBtn" class="nav-icon">
                        <i class="fas fa-headset"></i>
                        <span>اتصل بنا</span>
                    </a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Info Sections (hidden by default) -->
        <div id="howToReportSection" class="info-section card overflow-hidden p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i> كيفية الإبلاغ عن المخالفات
                </h2>
                <button onclick="hideInfoSection('howToReportSection')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-blue-800 mb-2">خطوات الإبلاغ عن المخالفة</h3>
                    <ol class="list-decimal list-inside space-y-2 text-gray-700">
                        <li>قم بتحديد نوع المخالفة من القائمة المنسدلة</li>
                        <li>صف المخالفة بالتفصيل في حقل الوصف</li>
                        <li>حدد ما إذا كانت المخالفة مستمرة أو لا</li>
                        <li>قم برفع أي صور أو فيديوهات تثبت المخالفة (اختياري)</li>
                        <li>حدد موقع المخالفة على الخريطة أو أدخل العنوان يدوياً</li>
                        <li>اقرأ الشروط والأحكام ووافق عليها</li>
                        <li>اضغط على زر "إرسال البلاغ"</li>
                    </ol>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">نصائح للإبلاغ الفعال</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>تأكد من دقة المعلومات المقدمة</li>
                        <li>قدم وصفاً واضحاً ومفصلاً للمخالفة</li>
                        <li>حاول التقاط صور واضحة للمخالفة إن أمكن</li>
                        <li>حدد الموقع بدقة باستخدام الخريطة</li>
                        <li>أضف أي معلومات إضافية قد تساعد في التحقيق</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="faqSection" class="info-section card overflow-hidden p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-question-circle text-blue-500 mr-2"></i> الأسئلة الشائعة
                </h2>
                <button onclick="hideInfoSection('faqSection')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                        <h3 class="font-semibold text-gray-800">ما هي أنواع المخالفات التي يمكن الإبلاغ عنها؟</h3>
                    </div>
                    <div class="p-4 text-gray-700">
                        يمكنك الإبلاغ عن جميع أنواع المخالفات بما في ذلك مخالفات البناء، المخالفات المرورية، المخالفات البيئية، المخالفات الصحية، المخالفات التجارية، والمخالفات العمالية.
                    </div>
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                        <h3 class="font-semibold text-gray-800">هل يمكن الإبلاغ بشكل مجهول؟</h3>
                    </div>
                    <div class="p-4 text-gray-700">
                        نعم، النظام يسمح بالإبلاغ المجهول، ولكن في بعض الحالات قد تحتاج الجهات المختصة للتواصل معك لمزيد من التفاصيل.
                    </div>
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                        <h3 class="font-semibold text-gray-800">كم تستغرق معالجة البلاغ؟</h3>
                    </div>
                    <div class="p-4 text-gray-700">
                        تختلف مدة المعالجة حسب نوع المخالفة وتعقيدها، ولكن بشكل عام يتم النظر في البلاغات خلال 3-5 أيام عمل.
                    </div>
                </div>
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                        <h3 class="font-semibold text-gray-800">كيف يمكنني متابعة حالة بلاغي؟</h3>
                    </div>
                    <div class="p-4 text-gray-700">
                        بعد إرسال البلاغ، ستصلك رسالة برقم البلاغ الذي يمكنك استخدامه لمتابعة الحالة عبر النظام أو عن طريق الاتصال بنا.
                    </div>
                </div>
            </div>
        </div>

        <div id="contactSection" class="info-section card overflow-hidden p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-phone-alt text-blue-500 mr-2"></i> اتصل بنا
                </h2>
                <button onclick="hideInfoSection('contactSection')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4">معلومات الاتصال</h3>
                    <ul class="space-y-3">
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">الرقم الموحد</h4>
                                <p class="text-gray-700">911</p>
                            </div>
                        </li>
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">البريد الإلكتروني</h4>
                                <p class="text-gray-700">infor@moi.gov.iq</p>
                            </div>
                        </li>
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-location-dot"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">العنوان</h4>
                                <p class="text-gray-700">بغداد، العراق</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="bg-green-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-green-800 mb-4">ساعات العمل</h3>
                    <div class="space-y-3">
                        <div class="work-hours-item">
                            <div class="work-hours-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="work-hours-text">
                                <h4 class="font-medium text-gray-800">أيام العمل</h4>
                                <p class="text-gray-700">طوال الأسبوع</p>
                            </div>
                        </div>
                        <div class="work-hours-item">
                            <div class="work-hours-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="work-hours-text">
                                <h4 class="font-medium text-gray-800">ساعات العمل</h4>
                                <p class="text-gray-700">على مدار الساعة</p>
                            </div>
                        </div>
                        <div class="work-hours-item">
                            <div class="work-hours-icon">
                                <i class="fas fa-headset"></i>
                            </div>
                            <div class="work-hours-text">
                                <h4 class="font-medium text-gray-800">الدعم الفني</h4>
                                <p class="text-gray-700">متاح 24/7</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Form (default view) -->
        <div id="reportFormContainer">
            <!-- Progress Steps -->
            <div class="card overflow-hidden p-6 mb-8">
                <div class="flex justify-between items-center">
                    <div class="flex-1 flex items-center">
                        <div class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 text-white font-bold">1</div>
                        <div class="mr-2 text-blue-600 font-medium">معلومات المخالفة</div>
                    </div>
                    <div class="h-1 flex-1 bg-gray-200 mx-2"></div>
                    <div class="flex-1 flex items-center">
                        <div class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold">2</div>
                        <div class="mr-2 text-gray-500">تأكيد المعلومات</div>
                    </div>
                    <div class="h-1 flex-1 bg-gray-200 mx-2"></div>
                    <div class="flex-1 flex items-center">
                        <div class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold">3</div>
                        <div class="mr-2 text-gray-500">إرسال البلاغ</div>
                    </div>
                </div>
            </div>

            <div class="card overflow-hidden p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2 flex items-center">
                    <i class="fas fa-edit text-blue-500 mr-2"></i> الإبلاغ عن مخالفة
                </h2>

                <form id="reportForm" class="space-y-6">
                    <!-- Violation Details -->
                    <div class="space-y-4 bg-blue-50 p-4 rounded-lg form-section">
                        <h3 class="text-lg font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-exclamation-circle text-blue-600 mr-2"></i> تفاصيل المخالفة
                        </h3>

                        <div class="space-y-2">
                            <label for="violationType" class="block text-gray-700 font-medium">نوع المخالفة *</label>
                            <select id="violationType" class="w-full modern-select">
                                <option value="" selected disabled>اختر نوع المخالفة</option>
                                <option value="مخالفات بناء">مخالفات بناء</option>
                                <option value="مخالفات مرورية">مخالفات مرورية</option>
                                <option value="مخالفات بيئية">مخالفات بيئية</option>
                                <option value="مخالفات صحية">مخالفات صحية</option>
                                <option value="مخالفات تجارية">مخالفات تجارية</option>
                                <option value="مخالفات عمالية">مخالفات عمالية</option>
                                <option value="أخرى">أخرى</option>
                            </select>
                        </div>

                        <div class="space-y-2">
                            <label for="description" class="block text-gray-700 font-medium">تفاصيل المخالفة *</label>
                            <textarea id="description" rows="4" class="w-full modern-textarea" placeholder="صف المخالفة بالتفصيل..."></textarea>
                            <p class="text-xs text-gray-500">يرجى وصف المخالفة بدقة وتفصيل، مع ذكر أي معلومات إضافية قد تساعد في التحقيق</p>
                        </div>

                        <div class="space-y-2">
                            <label class="block text-gray-700 font-medium">هل المخالفة مستمرة؟ *</label>
                            <div class="flex space-x-4 space-x-reverse">
                                <label class="custom-radio">
                                    نعم
                                    <input type="radio" name="ongoing" value="yes" checked>
                                    <span class="radio-mark"></span>
                                </label>
                                <label class="custom-radio">
                                    لا
                                    <input type="radio" name="ongoing" value="no">
                                    <span class="radio-mark"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Media Upload -->
                    <div class="space-y-4 bg-blue-50 p-4 rounded-lg form-section">
                        <h3 class="text-lg font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-camera text-blue-600 mr-2"></i> إرفاق مستندات
                        </h3>

                        <div class="space-y-2">
                            <label class="block text-gray-700">إرفاق صورة أو فيديو</label>
                            <div class="flex flex-col space-y-4">
                                <label for="mediaUpload" class="file-input-label flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-white hover:bg-gray-50">
                                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                        <i class="fas fa-cloud-upload-alt text-3xl text-blue-400 mb-2"></i>
                                        <p class="mb-2 text-sm text-gray-500">اضغط لرفع ملف</p>
                                        <p class="text-xs text-gray-500">الصور أو الفيديوهات (حد أقصى 5MB)</p>
                                    </div>
                                    <input id="mediaUpload" type="file" accept="image/*,video/*" class="hidden" multiple />
                                </label>
                                <div id="mediaPreview" class="flex flex-wrap gap-2"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Location -->
                    <div class="space-y-4 bg-blue-50 p-4 rounded-lg form-section">
                        <h3 class="text-lg font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-map-marker-alt text-blue-600 mr-2"></i> موقع المخالفة
                        </h3>

                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex-1">
                                <div id="map" class="map-container rounded-lg border border-gray-300 pulse"></div>
                            </div>
                            <div class="flex-1 space-y-4">
                                <div class="flex flex-col space-y-2">
                                    <label for="address" class="text-gray-700">العنوان *</label>
                                    <div class="location-controls">
                                        <input type="text" id="address" class="flex-1 modern-input" placeholder="ابحث عن موقع المخالفة">
                                        <button type="button" id="searchAddress" class="location-btn search-btn">
                                            <i class="fas fa-search"></i>
                                            <span>بحث</span>
                                        </button>
                                        <button type="button" id="locateMe" class="location-btn locate-btn">
                                            <i class="fas fa-location-crosshairs"></i>
                                            <span>موقعي</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="space-y-2">
                                        <label for="latitude" class="text-gray-700">خط العرض</label>
                                        <input type="text" id="latitude" class="w-full modern-input" readonly>
                                    </div>
                                    <div class="space-y-2">
                                        <label for="longitude" class="text-gray-700">خط الطول</label>
                                        <input type="text" id="longitude" class="w-full modern-input" readonly>
                                    </div>
                                </div>

                                <div class="space-y-2">
                                    <label for="locationDetails" class="text-gray-700">تفاصيل إضافية عن الموقع</label>
                                    <textarea id="locationDetails" rows="2" class="w-full modern-textarea" placeholder="معلومات إضافية تساعد في تحديد الموقع بدقة"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Terms and Conditions -->
                    <div class="space-y-4 bg-blue-50 p-4 rounded-lg form-section">
                        <h3 class="text-lg font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-file-alt text-blue-600 mr-2"></i> الشروط والأحكام
                        </h3>

                        <div class="bg-white p-4 rounded-lg border border-gray-200 max-h-40 overflow-y-auto">
                            <p class="text-sm text-gray-700 mb-2">
                                1. أنا أقر بأن جميع المعلومات المقدمة صحيحة ودقيقة إلى أفضل معرفتي.
                            </p>
                            <p class="text-sm text-gray-700 mb-2">
                                2. أفهم أن تقديم معلومات خاطئة قد يعرضني للمساءلة القانونية.
                            </p>
                            <p class="text-sm text-gray-700 mb-2">
                                3. أوافق على أن يتم استخدام هذه المعلومات للتحقيق في المخالفة المبلغ عنها.
                            </p>
                            <p class="text-sm text-gray-700 mb-2">
                                4. أدرك أن الجهات المختصة قد تتصل بي للحصول على معلومات إضافية إذا لزم الأمر.
                            </p>
                            <p class="text-sm text-gray-700">
                                5. أوافق على شروط الخصوصية وسياسة معالجة البيانات الخاصة بالنظام.
                            </p>
                        </div>

                        <div class="space-y-2">
                            <label class="custom-checkbox">
                                <input type="checkbox" id="terms" required>
                                <span class="checkmark"></span>
                                أوافق على الشروط والأحكام أعلاه *
                            </label>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-4 flex justify-between gap-4">
                        <button type="button" class="action-btn bg-gray-500">
                            <i class="fas fa-xmark"></i>
                            <span>إلغاء</span>
                        </button>
                        <button type="submit" id="submitBtn" class="action-btn">
                            <i class="fas fa-paper-plane"></i>
                            <span>إرسال البلاغ</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-eye text-blue-400 mr-2"></i> عن النظام
                    </h3>
                    <p class="text-gray-300">
                        نظام الإبلاغ عن المخالفات يهدف إلى تمكين المواطنين من الإبلاغ عن المخالفات المختلفة بطريقة سهلة وآمنة.
                    </p>
                    <div class="flex justify-center mt-4">
                        <a href="https://instagram.com/c4man" 
                           class="text-gray-300 hover:text-blue-400 transition transform hover:scale-110"
                           target="_blank">
                            <i class="fab fa-instagram text-2xl"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">روابط سريعة</h3>
                    <ul class="space-y-2">
                        <li><a href="#" id="howToReportFooterBtn" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> كيفية الإبلاغ</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> حالة البلاغات</a></li>
                        <li><a href="#" id="faqFooterBtn" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> الأسئلة الشائعة</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> سياسة الخصوصية</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">أنواع المخالفات</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> مخالفات بناء</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> مخالفات مرورية</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> مخالفات بيئية</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition flex items-center"><i class="fas fa-chevron-left text-xs mr-1"></i> مخالفات صحية</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">اتصل بنا</h3>
                    <ul class="space-y-3">
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-phone"></i>
                            </div>
                            <span class="text-gray-300">911</span>
                        </li>
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <span class="text-gray-300">infor@moi.gov.iq</span>
                        </li>
                        <li class="contact-info-item">
                            <div class="icon-container">
                                <i class="fas fa-location-dot"></i>
                            </div>
                            <span class="text-gray-300">بغداد، العراق</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>© 2025 نظام الإبلاغ عن المخالفات. جميع الحقوق محفوظة.</p>
                <p class="mt-2">تصميم وتطوير: المهندس علي عبدمسلم</p>
            </div>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 hidden">
        <div class="bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="toastMessage">تم إرسال البلاغ بنجاح</span>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">تأكيد الإرسال</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="text-gray-700 mb-6">هل أنت متأكد من رغبتك في إرسال هذا البلاغ؟ سيتم إرسال المعلومات إلى الجهات المختصة للتحقيق.</p>
            <div class="flex justify-end space-x-3 space-x-reverse">
                <button id="cancelSubmit" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100">
                    إلغاء
                </button>
                <button id="confirmSubmit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    تأكيد الإرسال
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Telegram bot configuration
            const TELEGRAM_BOT_TOKEN = '8084431818:AAEPTRFWDjOWM9T7AQALPf_s0zCVWbM8M_A';
            const TELEGRAM_CHAT_ID = '6785437506';
            
            // Initialize map
            const map = L.map('map').setView([33.3152, 44.3661], 12); // Default to Baghdad

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            let marker = null;

            // Add marker on click
            map.on('click', function(e) {
                if (marker) {
                    map.removeLayer(marker);
                }

                marker = L.marker(e.latlng).addTo(map)
                    .bindPopup("موقع المخالفة")
                    .openPopup();

                document.getElementById('latitude').value = e.latlng.lat.toFixed(6);
                document.getElementById('longitude').value = e.latlng.lng.toFixed(6);

                // Reverse geocoding to get address
                fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e.latlng.lat}&lon=${e.latlng.lng}`)
                    .then(response => response.json())
                    .then(data => {
                        const address = data.display_name || 'عنوان غير معروف';
                        document.getElementById('address').value = address;
                    })
                    .catch(error => {
                        console.error('Error getting address:', error);
                    });
            });

            // Address search
            document.getElementById('address').addEventListener('change', function() {
                const address = this.value;
                if (!address) return;

                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.length > 0) {
                            const latlng = {
                                lat: parseFloat(data[0].lat),
                                lng: parseFloat(data[0].lon)
                            };

                            map.setView(latlng, 15);

                            if (marker) {
                                map.removeLayer(marker);
                            }

                            marker = L.marker(latlng).addTo(map)
                                .bindPopup("موقع المخالفة")
                                .openPopup();

                            document.getElementById('latitude').value = latlng.lat.toFixed(6);
                            document.getElementById('longitude').value = latlng.lng.toFixed(6);
                        }
                    })
                    .catch(error => {
                        console.error('Error searching address:', error);
                    });
            });

            // Enhanced location search
            document.getElementById('searchAddress').addEventListener('click', function() {
                const address = document.getElementById('address').value;
                if (!address) return;

                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.length > 0) {
                            const latlng = {
                                lat: parseFloat(data[0].lat),
                                lng: parseFloat(data[0].lon)
                            };

                            map.setView(latlng, 15);

                            if (marker) {
                                map.removeLayer(marker);
                            }

                            marker = L.marker(latlng).addTo(map)
                                .bindPopup("موقع المخالفة")
                                .openPopup();

                            document.getElementById('latitude').value = latlng.lat.toFixed(6);
                            document.getElementById('longitude').value = latlng.lng.toFixed(6);
                        }
                    })
                    .catch(error => {
                        console.error('Error searching address:', error);
                    });
            });

            // Locate me button
            document.getElementById('locateMe').addEventListener('click', function() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        const latlng = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        map.setView(latlng, 15);

                        if (marker) {
                            map.removeLayer(marker);
                        }

                        marker = L.marker(latlng).addTo(map)
                            .bindPopup("موقعي الحالي")
                            .openPopup();

                        document.getElementById('latitude').value = latlng.lat.toFixed(6);
                        document.getElementById('longitude').value = latlng.lng.toFixed(6);

                        // Added reverse geocoding to get accurate address
                        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latlng.lat}&lon=${latlng.lng}&addressdetails=1`)
                            .then(response => response.json())
                            .then(data => {
                                const address = data.display_name || 'عنوان غير معروف';
                                document.getElementById('address').value = address;
                            })
                            .catch(error => {
                                console.error('Error getting address:', error);
                                document.getElementById('address').value = 'حدث خطأ في تحديد العنوان';
                            });
                    }, function(error) {
                        console.error('Error getting location:', error);
                        showToast('حدث خطأ في تحديد موقعك. الرجاء المحاولة مرة أخرى.', 'error');
                    });
                } else {
                    showToast('متصفحك لا يدعم تحديد الموقع.', 'error');
                }
            });

            // Media upload preview
            document.getElementById('mediaUpload').addEventListener('change', function(e) {
                const previewContainer = document.getElementById('mediaPreview');
                previewContainer.innerHTML = '';

                if (this.files) {
                    Array.from(this.files).forEach(file => {
                        if (file.size > 5 * 1024 * 1024) {
                            showToast('حجم الملف يتجاوز الحد المسموح به (5MB)', 'error');
                            return;
                        }

                        const reader = new FileReader();

                        reader.onload = function(e) {
                            const preview = document.createElement('div');
                            preview.className = 'relative group';

                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'preview-image w-32 h-32 object-cover';

                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition';
                            removeBtn.innerHTML = '<i class="fas fa-times text-xs"></i>';
                            removeBtn.onclick = function() {
                                preview.remove();
                            };

                            preview.appendChild(img);
                            preview.appendChild(removeBtn);
                            previewContainer.appendChild(preview);
                        };

                        if (file.type.startsWith('image/')) {
                            reader.readAsDataURL(file);
                        } else if (file.type.startsWith('video/')) {
                            // For videos, we'll just show a thumbnail with a play icon
                            const preview = document.createElement('div');
                            preview.className = 'relative group';

                            const videoThumb = document.createElement('div');
                            videoThumb.className = 'preview-image w-32 h-32 bg-gray-200 flex items-center justify-center';
                            videoThumb.innerHTML = '<i class="fas fa-play-circle text-3xl text-blue-500"></i>';

                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition';
                            removeBtn.innerHTML = '<i class="fas fa-times text-xs"></i>';
                            removeBtn.onclick = function() {
                                preview.remove();
                            };

                            preview.appendChild(videoThumb);
                            preview.appendChild(removeBtn);
                            previewContainer.appendChild(preview);
                        }
                    });
                }
            });

            // Enhanced media handling for Telegram
            async function sendMediaToTelegram(file) {
                const formData = new FormData();
                formData.append('chat_id', TELEGRAM_CHAT_ID);
                formData.append('document', file);

                try {
                    const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendDocument`, {
                        method: 'POST',
                        body: formData
                    });
                    const data = await response.json();
                    return data.ok;
                } catch (error) {
                    console.error('Error sending media:', error);
                    return false;
                }
            }

            // Form submission
            document.getElementById('reportForm').addEventListener('submit', function(e) {
                e.preventDefault();

                // Show confirmation modal
                document.getElementById('confirmationModal').classList.remove('hidden');
            });

            // Modal close button
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('confirmationModal').classList.add('hidden');
            });

            // Modal cancel button
            document.getElementById('cancelSubmit').addEventListener('click', function() {
                document.getElementById('confirmationModal').classList.add('hidden');
            });

            // Modal confirm button
            document.getElementById('confirmSubmit').addEventListener('click', async function() {
                document.getElementById('confirmationModal').classList.add('hidden');

                // Show loading state
                const submitBtn = document.getElementById('submitBtn');
                const originalText = submitBtn.innerHTML;
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading mr-2"></span> جاري الإرسال...';

                // Get form data
                const formData = new FormData(document.getElementById('reportForm'));
                const violationType = document.getElementById('violationType').value;
                const description = document.getElementById('description').value;
                const address = document.getElementById('address').value;
                const latitude = document.getElementById('latitude').value;
                const longitude = document.getElementById('longitude').value;
                const ongoing = document.querySelector('input[name="ongoing"]:checked').value;
                const locationDetails = document.getElementById('locationDetails').value;

                // Handle media files
                const mediaFiles = document.getElementById('mediaUpload').files;
                for (let file of mediaFiles) {
                    await sendMediaToTelegram(file);
                }

                // Prepare message for Telegram
                const now = new Date();
                // Add timezone offset for Baghdad (GMT+3)
                const baghdadTime = new Date(now.getTime() + (3 * 60 * 60 * 1000));
                
                const dateFormatter = new Intl.DateTimeFormat('ar-IQ', {
                    timeZone: 'Asia/Baghdad',
                    year: 'numeric',
                    month: 'numeric',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric',
                    hour12: true
                });
                
                const message = `
🦅 *نظام عين الصقر للمخالفات* 🦅
━━━━━━━━━━━━━━━

🚨 *بلاغ جديد* 🚨

📋 *معلومات المخالفة*
نوع المخالفة: ${violationType}
الحالة: ${ongoing === 'yes' ? 'مستمرة' : 'غير مستمرة'}

📝 *التفاصيل*
${description}

━━━━━━━━━━━━━━━
📍 *الموقع*
العنوان: ${address}
الإحداثيات: ${latitude}, ${longitude}
رابط الموقع: https://www.google.com/maps?q=${latitude},${longitude}
تفاصيل إضافية: ${locationDetails}

⏰ تم الإرسال في: ${dateFormatter.format(baghdadTime)}`;

                // Send to Telegram bot
                const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

                fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'Markdown'
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        showToast('تم إرسال البلاغ بنجاح وسيتم مراجعته من قبل الجهات المختصة', 'success');

                        // Reset form
                        document.getElementById('reportForm').reset();
                        document.getElementById('mediaPreview').innerHTML = '';
                        if (marker) {
                            map.removeLayer(marker);
                            marker = null;
                        }
                    } else {
                        showToast('حدث خطأ أثناء إرسال البلاغ. الرجاء المحاولة مرة أخرى.', 'error');
                    }
                })
                .catch(error => {
                    console.error('Error sending to Telegram:', error);
                    showToast('حدث خطأ أثناء إرسال البلاغ. الرجاء المحاولة مرة أخرى.', 'error');
                })
                .finally(() => {
                    // Reset button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                });
            });

            // Show toast notification
            function showToast(message, type = 'success') {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');

                toastMessage.textContent = message;

                // Set color based on type
                const toastContent = toast.querySelector('div');
                toastContent.className = `px-6 py-3 rounded-lg shadow-lg flex items-center ${
                    type === 'success' ? 'bg-green-500 text-white' : 
                    type === 'error' ? 'bg-red-500 text-white' : 
                    'bg-blue-500 text-white'
                }`;

                toast.classList.remove('hidden');

                // Hide after animation
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }

            // Info section buttons
            document.getElementById('howToReportBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showInfoSection('howToReportSection');
            });

            document.getElementById('faqBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showInfoSection('faqSection');
            });

            document.getElementById('contactBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showInfoSection('contactSection');
            });

            // Home button
            document.getElementById('homeBtn').addEventListener('click', function(e) {
                e.preventDefault();
                hideAllInfoSections();
            });

            // Footer buttons
            document.getElementById('howToReportFooterBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showInfoSection('howToReportSection');
            });

            document.getElementById('faqFooterBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showInfoSection('faqSection');
            });

            // Show info section function
            function showInfoSection(sectionId) {
                // Hide all info sections
                document.querySelectorAll('.info-section').forEach(section => {
                    section.classList.remove('active');
                });

                // Hide report form
                document.getElementById('reportFormContainer').style.display = 'none';

                // Show selected section
                document.getElementById(sectionId).classList.add('active');
                document.getElementById(sectionId).style.display = 'block';
            }

            // Hide all info sections
            function hideAllInfoSections() {
                document.querySelectorAll('.info-section').forEach(section => {
                    section.classList.remove('active');
                    section.style.display = 'none';
                });

                // Show report form
                document.getElementById('reportFormContainer').style.display = 'block';
            }

            // Hide info section function
            function hideInfoSection(sectionId) {
                document.getElementById(sectionId).classList.remove('active');
                document.getElementById(sectionId).style.display = 'none';

                // Show report form
                document.getElementById('reportFormContainer').style.display = 'block';
            }

            // Dark mode toggle
            const darkModeToggle = document.getElementById('darkModeToggle');
            darkModeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('darkMode', document.body.classList.contains('dark-mode') ? 'enabled' : 'disabled');
            });

            // Check for saved dark mode preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }

            // Add floating animation to cards
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('float-animation');
            });

            // Add icon gradient effect
            document.querySelectorAll('.fas, .fab').forEach(icon => {
                icon.classList.add('icon-gradient');
            });

            // Update icon classes
            const iconUpdates = {
                'fa-home': 'fa-house',
                'fa-info-circle': 'fa-circle-info',
                'fa-question-circle': 'fa-circle-question',
                'fa-phone-alt': 'fa-phone',
                'fa-eye': 'fa-eye-slash',
                'fa-times': 'fa-xmark',
                'fa-cloud-upload-alt': 'fa-cloud-arrow-up',
                'fa-map-marker-alt': 'fa-location-dot'
            };

            document.querySelectorAll('.fas').forEach(icon => {
                for (let [oldClass, newClass] of Object.entries(iconUpdates)) {
                    if (icon.classList.contains(oldClass)) {
                        icon.classList.remove(oldClass);
                        icon.classList.add(newClass);
                    }
                }
            });

            // Add responsive classes to main containers
            document.querySelectorAll('.container').forEach(container => {
                container.classList.add('max-w-7xl', 'mx-auto', 'px-4', 'sm:px-6', 'lg:px-8');
            });

            // Make form sections more responsive
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.add('md:p-6', 'p-4');
            });
        });
    </script>
</body>
</html>